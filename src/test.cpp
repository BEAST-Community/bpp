//
// Created by Kevin Gori on 26.
//

#include "test.h"

int main(int argc, char** argv) {
    std::string ALIGNMENT = "data/ens_aln.phy";
    std::string TREE = "(ENSACAP00000006395_Acar:0.57642002,ENSACAP00000006392_Acar:0.84848693,(ENSPSIP00000002669_Psin:0.58132373,((ENSOCUP00000018251_Ocun:0.49755414,((ENSMUSP00000044765_Mmus:0.26792573,ENSRNOP00000064282_Rnor:0.22385432):0.69504634,(((ENSTSYP00000006225_Tsyr:0.51317646,((ENSPPYP00000001409_Pabe:0.03466590,(ENSP00000359787_Hsap:0.00988592,(ENSGGOP00000013320_Ggor:0.01687230,ENSPTRP00000001544_Ptro:0.00562149):0.01243281):0.03823776):0.03168558,(ENSCJAP00000013323_Cjac:0.26120947,(ENSMMUP00000002094_Mmul:0.03050194,(ENSPANP00000005938_Panu:0.00853924,ENSCSAP00000016612_Csab:0.03087094):0.00353619):0.05727773):0.00933823):0.23260578):0.04716981,((ENSSTOP00000019976_Itri:0.32535988,ENSDORP00000014390_Dord:0.53499297):0.09664634,(ENSTBEP00000000876_Tbel:0.46265186,ENSMICP00000014398_Mmur:0.32335880):0.07240856):0.02000969):0.04971245,(((ENSMLUP00000007882_Mluc:0.52341146,ENSECAP00000007567_Ecab:0.33354584):0.06643876,(((ENSBTAP00000031029_Btau:0.09395463,ENSOARP00000014392_Oari:0.12132570):0.19782841,(ENSSSCP00000025283_Sscr:0.33928794,ENSVPAP00000008555_Vpac:0.32379008):0.05768659):0.11949482,((ENSEEUP00000006274_Eeur:0.60118232,ENSSARP00000012386_Sara:0.86624761):0.21222310,(ENSFCAP00000012253_Fcat:0.37117029,(ENSCAFP00000030171_Cfam:0.37412439,(ENSMPUP00000010668_Mpfu:0.28394063,ENSAMEP00000019285_Amel:0.17921066):0.08595550):0.15396371):0.16192267):0.06658513):0.03889099):0.06029169,(ENSLAFP00000015326_Lafr:0.46229833,(ENSCHOP00000009020_Chof:0.39665952,ENSDNOP00000027817_Dnov:0.21983663):0.16883395):0.09646978):0.01976386):0.04963743):0.05098762):0.47755999,(ENSETEP00000006546_Etel:0.91735709,((ENSPCAP00000001653_Pcap:0.40430864,ENSLAFP00000012639_Lafr:0.32578774):0.14959072,((ENSCHOP00000008829_Chof:0.34317395,ENSDNOP00000005661_Dnov:0.40457251):0.12542558,(ENSEEUP00000003911_Eeur:0.69174820,(((ENSMLUP00000019484_Mluc:0.41180243,(ENSFCAP00000024915_Fcat:0.47933275,(ENSCAFP00000030169_Cfam:0.29941518,(ENSAMEP00000019281_Amel:0.23453252,ENSMPUP00000010665_Mpfu:0.20587053):0.08254865):0.08247071):0.11096186):0.04818129,(ENSECAP00000006938_Ecab:0.54116335,(ENSSSCP00000004071_Sscr:0.40651417,(ENSVPAP00000008558_Vpac:0.31204736,(ENSBTAP00000045648_Btau:0.08182975,ENSOARP00000014407_Oari:0.10644899):0.31509292):0.04171124):0.11857358):0.02373544):0.02880002,((((ENSTBEP00000002103_Tbel:0.39927715,ENSOCUP00000005604_Ocun:0.52259970):0.06716652,(ENSDORP00000014393_Dord:0.40385706,(ENSMUSP00000029671_Mmus:0.24257944,ENSRNOP00000031735_Rnor:0.25820837):0.48952899):0.07240112):0.07779990,(ENSTSYP00000005897_Tsyr:0.45524458,ENSMICP00000001124_Mmur:0.36246746):0.07484010):0.02685466,(ENSSTOP00000012110_Itri:0.39234371,((ENSMMUP00000039875_Mmul:0.03867349,(ENSPANP00000018344_Panu:0.02146208,ENSCSAP00000016611_Csab:0.03256619):0.03723273):0.07567567,(ENSPPYP00000001408_Pabe:0.05115814,(ENSGGOP00000013329_Ggor:0.00588229,(ENSPTRP00000001546_Ptro:0.01467160,ENSP00000359783_Hsap:0.01463414):0.00285638):0.02103120):0.05562624):0.32128906):0.05102293):0.04505200):0.03578920):0.06920996):0.03441281):0.08361345):0.45371116):1.38261117):0.36167068);";
    Alignment* al = new Alignment(ALIGNMENT, "phylip", true);
    al->set_substitution_model("LG08");
    al->set_gamma_rate_model(4, 0.916);
    al->initialise_likelihood(TREE);
    std::cout << "Likelihood: " << al->get_likelihood() << std::endl;
    std::cout << al->get_abayes_tree() << std::endl;
    delete al;
}